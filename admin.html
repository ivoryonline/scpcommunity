<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SCP Foundation - Admin Panel</title>
    <link rel="stylesheet" href="styles/global.css">
    <link rel="stylesheet" href="styles/application.css">
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
</head>
<body>
    <div class="container">
        <h1>Admin - Invite Token Generator</h1>
        <form id="inviteTokenForm">
            <div class="form-group">
                <label>Real Age</label>
                <input type="number" id="realAge" required>
            </div>
            <div class="form-group">
                <label>Role</label>
                <select id="role" required>
                    <option value="class-d">Class-D Personnel</option>
                    <option value="janitorial-staff">Janitorial Staff</option>
                </select>
            </div>
            <div class="form-group">
                <label>Character Name</label>
                <input type="text" id="characterName" required>
            </div>
            <div class="form-group">
                <label>Character Gender</label>
                <input type="text" id="characterGender">
            </div>
            <div class="form-group">
                <label>Character Age</label>
                <input type="number" id="characterAge" required>
            </div>
            <div class="form-group">
                <label>Physical Appearance</label>
                <textarea id="physicalAppearance" required></textarea>
            </div>
            <div class="form-group">
                <label>Background/Origin</label>
                <textarea id="background" required></textarea>
            </div>
            <div class="form-group">
                <label>Personality Traits</label>
                <textarea id="personalityTraits" required></textarea>
            </div>
            <div class="form-group">
                <label>Skills & Abilities</label>
                <textarea id="skillsAbilities" required></textarea>
            </div>
            <button type="submit" class="submit-btn">Generate Invite Token</button>
        </form>
        <div id="tokenResult" class="token-result"></div>
    </div>

    <script>
        document.getElementById('inviteTokenForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            // Collect form data
            const formData = {
                realAge: document.getElementById('realAge').value,
                role: document.getElementById('role').value,
                characterName: document.getElementById('characterName').value,
                characterGender: document.getElementById('characterGender').value,
                characterAge: document.getElementById('characterAge').value,
                physicalAppearance: document.getElementById('physicalAppearance').value,
                background: document.getElementById('background').value,
                personalityTraits: document.getElementById('personalityTraits').value,
                skillsAbilities: document.getElementById('skillsAbilities').value
            };

            // Generate a unique invite token
            const inviteToken = firebase.firestore().collection('inviteTokens').doc().id;

            // Save token with application data
            try {
                await firebase.firestore().collection('inviteTokens').doc(inviteToken).set({
                    ...formData,
                    used: false,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });

                document.getElementById('tokenResult').innerHTML = 
                    `Generated Invite Token: <strong>${inviteToken}</strong>`;
            } catch (error) {
                console.error('Error generating token:', error);
                alert('Failed to generate invite token');
            }
        });
    </script>
</body>
</html>